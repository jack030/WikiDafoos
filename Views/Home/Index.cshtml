@{
    ViewData["Title"] = "دانشنامه دافوس";

}
@model WikiDafoos.Models.ViewModel.HomeIndexViewModel
<div class="hero-section landing-page bg-light p-5 mb-4 rounded-3">
    <div class="container-fluid py-5 text-center">

        <!-- Optimized Responsive Image -->
        <img src="~/images/dafoos.svg"
             alt="WikiDafoos Logo"
             class="img-fluid mx-auto d-block my-4"
             style="max-height: 300px; width: auto;"
             loading="eager"> <!-- eager loading for above-the-fold content -->
        <p class="fs-4">به ویکی دافوس خوش آمدید</p>

    </div>
    <div class="row justify-content-center">
        <div class="col-12 col-lg-4 position-relative">
            <form class="d-flex" method="get" asp-controller="Search" asp-action="Search">
                <div class="input-group">
                    <input type="text" id="liveSearch" class="form-control index-search-input"
                           placeholder="جستجو..." aria-label="Search" name="query" dir="rtl">
                    <button class="btn fw-bold search-btn" type="submit">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 14 14">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                        </svg>
                    </button>
                </div>
            </form>

            <ul id="searchResults" class="list-group position-absolute w-100 z-3 mt-1 d-none"></ul>
        </div>
    </div>

  
</div>




<div class="container articles">


    @* readmore box *@
    <div class="read-more">

        <div>
            <img src="images/readmore.png"></img>
        </div>
    </div>

    <div class="read-more-mouse">

        <div>
            <img src="images/mouse.png"></img>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5>آخرین مقالات</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        @foreach(var t in Model.LatestArticles)
                        {
                            <li class="list-group-item"><a href="/Article/Details/${@t.Id}">@t.Title</a></li>
                        }

                        
                       @*  <li class="list-group-item"><a href="#">ARticle 2</a></li>
                        <li class="list-group-item"><a href="#">Article 3</a></li> *@
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h5>پر بازدیدترین‌ها</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex flex-wrap gap-2">
                        @foreach (var t in Model.TopViewArticles)
                        {
                            <li class="list-group-item"><a href="/Article/Details/${@t.Id}">@t.Title</a></li>
                        }
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    <h5>مقالات برگزیده</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        @foreach (var t in Model.SuggestedArticles)
                        {
                            <li class="list-group-item"><a href="/Article/Details/${@t.Id}">@t.Title</a></li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h4>Featured Article</h4>
                </div>
                <div class="card-body">
                    <h5 class="card-title">The History of Foosball in Iran</h5>
                    <p class="card-text">Foosball was introduced to Iran in the 1970s and quickly gained popularity among university students. The game became particularly popular in Tehran, where the first official tournaments were held in the early 1990s...</p>
                    <a href="#" class="btn btn-outline-primary">Read More</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('liveSearch').addEventListener('input', async function () {
        const query = this.value.trim();
        const resultsList = document.getElementById('searchResults');

        if (query.length < 2) {
            resultsList.classList.add('d-none');
            resultsList.innerHTML = '';
            return;
        }

        const response = await fetch(`/Article/SearchArticles?query=${encodeURIComponent(query)}`);
        const data = await response.json();

        resultsList.innerHTML = '';
        if (data.length > 0) {
            data.forEach(article => {
                const li = document.createElement('li');
                li.className = 'list-group-item list-group-item-action';
                li.innerHTML = `<a href="/Article/Details/${article.id}" class="text-decoration-none d-block">${article.title}</a>`;
                resultsList.appendChild(li);
            });
            resultsList.classList.remove('d-none');
        } else {
            resultsList.classList.add('d-none');
        }
    });
</script>
